{% extends 'places_core/base.html' %}{% load staticfiles i18n civil_tags map_tags %}

{% block title %}{% trans "Create location" %}{% endblock %}

{% block require_scripts %}<script>
(function (app) {
	"use strict";
	app.countryList = [];
	{% for c in countries %}app.countryList.push({id:"{{ c.location.pk }}",name:"{{ c.location.name }}"});{% endfor %}
	app.markers = [];
	{% if location %}{% get_map_pointers location as MARKERS %}{% for m in MARKERS %}app.markers.push({
		lat: parseFloat(("{{ m.latitude }}").replace(',', '.')),
		lng: parseFloat(("{{ m.longitude }}").replace(',', '.')),
		id: {{ m.pk }}
	});{% endfor %}{% endif %}
})(CivilApp || {});
</script>
<script src="{% static 'places_core' %}/js/{% js_path %}/location-create.js"></script>{% endblock %}

{% block header %}<div class="headerBGa headerBGLocationFrom">
	<h1 class="headerTitleBG"> {{ title | capfirst }} <small>{{ subtitle | capfirst }}</small></h1>
</div>{% endblock %}

{% block content %}<div class="col-sm-3 top15">
	<div class="sidebar left">
		<div class="sidebar-label">{% trans "Rules" %}</div>
		{% if action and action == 'edit' %}<div class="sidebar-label">{% trans 'Delete this location' %}</div>
		<div class="sidebar-content">
			{% if user.is_superuser %}<form style="display:inline;" method="post" action="{% url 'locations:delete' location.slug %}">{% csrf_token %}
      	  <button id="danger-button" type="submit" class="btn btn-danger btn-bg">{% trans 'Delete' %}</button>
    	</form>{% endif %}
   	</div>{% endif %}
	</div>
</div>
<div class="col-sm-9 main-content top15 p25">
	<div class="create-form">
		{% if action and action == 'edit' %}<form class="form-horizontal" role="form" action="{% url 'locations:update' location.slug %}" enctype="multipart/form-data" method="post" id="new-location-form">
		{% else %}<form class="form-horizontal" role="form" action="{% url 'locations:create' %}" enctype="multipart/form-data" method="post" id="new-location-form">{% endif %}
			{% csrf_token %}
			<div class="form-group">
				<label class="control-label col-sm-2">
					<label for="id_name">{% trans "Name" %}:</label>
				</label>
				<div class="col-sm-10">{{ form.name }}</div>
			</div>
			<div class="form-group">
				<label class="control-label col-sm-2">
					<label for="id_description">{% trans "Description" %}:</label>
				</label>
				<div class="col-sm-10">{{ form.description }}</div>
			</div>
			<div class="form-group">
				<label class="control-label col-sm-2">
					<label for="id_country_code">{% trans "Country code" %}:</label>
				</label>
				<div class="col-sm-10">
					<select name="country_code" id="id_country_code" class="form-control">
						{% for x,y in form.fields.country_code.choices %}<option value="{{ x }}"{% if location.country_code == y %} selected{% endif %}>{{ y }}</option>{% endfor %}
					</select>
				</div>
			</div>
			<div class="form-group">
				<label class="control-label col-sm-2">
					<label for="id_parent">{% trans "Parent" %}:</label>
				</label>
				<div class="col-sm-10">{{ form.parent }}</div>
			</div>
			<div class="form-group">
				<label class="control-label col-sm-2">
					<label for="id_population">{% trans "Population" %}:</label>
				</label>
				<div class="col-sm-10">{{ form.population }}</div>
			</div>
			<p class="col-sm-offset-2">* {% trans "If this entry is about a specific location, you can mark it on the map" %}</p>
			<div class="form-group">
				<label class="control-label col-sm-2">
					<label for="id_latitude"></label>
				</label>
				<div class="col-sm-10">{{ form.latitude }}</div>
			</div>
			<div class="form-group">
				<label class="control-label col-sm-2">
					<label for="id_longitude"></label>
				</label>
				<div class="col-sm-10">{{ form.longitude }}</div>
			</div>{% comment %} There is anyways picture uploader, much better than just file field.
			<div class="form-group">
				<label class="control-label col-sm-2">
					<label for="id_image">{% trans "Image" %}:</label>
				</label>
				<div class="col-sm-10">{{ form.image }}</div>
			</div>
			<div class="form-group">        
				<div class="addImageWidth">
					<h5>* {% trans "The image should have a width and height of 3840px by 600px" %}</h5>
				</div>
			</div>
			{% endcomment %}<div class="form-group">
				<div class="col-sm-2">&nbsp;</div>
				<div class="col-sm-10 text-right">
					<button type="submit" class="btn btn-greenBig">{% if action and action == 'edit' %}{% trans "Save changes" %}{% else %}{% trans "Create new location" %}{% endif %}</button>
				</div>
			</div>
		</form>
	</div>
</div>
<script type="text/template" id="input-tpl">
	<div class="btn btn-createLocation custom-btn-full-width input-indicator"></div>
	<ul class="sublist">
		<li class="filter-entry">
			<form role="presentation">
				<input type="text" class="search-filter form-control input-sm" placeholder="{% trans "Filter" %}...">
			</form>
		</li>
	</ul>
</script>{% endblock %}